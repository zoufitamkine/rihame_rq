<!-- Slider Section -->
<div class="relative w-full overflow-hidden shadow-2xl -mt-4 md:-mt-6 lg:-mt-8">
    <div class="flex transition-transform duration-700 ease-in-out" id="slider-container">
        {% for s in sliders %}
        <div class="min-w-full relative">
            <!-- Image Container -->
            <div class="relative w-full">
                <img src="{{ s.image.url }}" 
                     alt="{% if lang == 'fr' %}{{ s.title_fr }}{% elif lang == 'en' %}{{ s.title_en }}{% else %}{{ s.title_ar }}{% endif %}"
                     class="w-full h-[500px] md:h-[600px] lg:h-[700px] object-contain">
                
                <!-- Overlay Gradient with Opacity -->
                <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"></div>
            </div>

            <!-- Content Overlay -->
            <div class="absolute inset-0 flex items-end">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8 pb-12 md:pb-16 lg:pb-20">
                    <div class="max-w-3xl">
                        <!-- Badge -->
                        <div class="mb-4 animate-fade-in">
                            <span class="inline-flex items-center gap-2 px-4 py-2 bg-[#D3B689] text-white text-sm font-semibold rounded-full shadow-lg">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                </svg>
                                {% if lang == 'fr' %}Nouveauté
                                {% elif lang == 'en' %}New Release
                                {% else %}جديد{% endif %}
                            </span>
                        </div>

                        <!-- Title -->
                        <h2 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 md:mb-6 text-white leading-tight drop-shadow-2xl animate-slide-up"
                            {% if lang == 'ar' %}dir="rtl"{% endif %}>
                            {% if lang == 'fr' %}{{ s.title_fr }}
                            {% elif lang == 'en' %}{{ s.title_en }}
                            {% else %}{{ s.title_ar }}{% endif %}
                        </h2>

                        <!-- Description -->
                        <div class="text-base sm:text-lg md:text-xl text-gray-200 mb-6 md:mb-8 leading-relaxed max-w-2xl drop-shadow-lg animate-slide-up-delay line-clamp-3"
                             {% if lang == 'ar' %}dir="rtl"{% endif %}>
                            {% if lang == 'fr' %}{{ s.description_fr|safe }}
                            {% elif lang == 'en' %}{{ s.description_en|safe }}
                            {% else %}{{ s.description_ar|safe }}{% endif %}
                        </div>

                        <!-- CTA Buttons -->
                        <div class="flex flex-col sm:flex-row gap-4 animate-slide-up-delay-2">
                            <a href="" 
                               class="group relative inline-flex items-center justify-center gap-3 px-8 py-4 bg-gradient-to-r from-[#D3B689] to-[#C9A97A] text-white font-bold text-base md:text-lg rounded-xl shadow-2xl hover:shadow-[#D3B689]/50 transform hover:-translate-y-1 transition-all duration-300 overflow-hidden">
                                <span class="absolute inset-0 bg-gradient-to-r from-[#C9A97A] to-[#D3B689] opacity-0 group-hover:opacity-100 transition-opacity duration-300"></span>
                                <svg class="w-6 h-6 relative z-10 group-hover:rotate-12 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
                                </svg>
                                <span class="relative z-10">
                                    {% if lang == 'fr' %}Découvrir les E-books
                                    {% elif lang == 'en' %}Discover E-books
                                    {% else %}اكتشف الكتب الإلكترونية{% endif %}
                                </span>
                                <svg class="w-5 h-5 relative z-10 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                </svg>
                            </a>

                            <a href="#" 
                               class="inline-flex items-center justify-center gap-2 px-8 py-4 bg-white/10 backdrop-blur-md text-white font-semibold text-base md:text-lg rounded-xl border-2 border-white/30 hover:bg-white/20 hover:border-white/50 transform hover:-translate-y-1 transition-all duration-300">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <span>
                                    {% if lang == 'fr' %}En savoir plus
                                    {% elif lang == 'en' %}Learn More
                                    {% else %}معرفة المزيد{% endif %}
                                </span>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Decorative Elements -->
            <div class="absolute top-10 right-10 w-32 h-32 bg-[#D3B689]/20 rounded-full blur-3xl animate-pulse"></div>
            <div class="absolute bottom-20 left-20 w-40 h-40 bg-[#C9A97A]/20 rounded-full blur-3xl animate-pulse delay-1000"></div>
        </div>
        {% endfor %}
    </div>

    <!-- Navigation Arrows -->
    <button onclick="prevSlide()" 
            class="absolute left-4 md:left-8 top-1/2 -translate-y-1/2 w-12 h-12 md:w-14 md:h-14 bg-white/10 backdrop-blur-md hover:bg-white/20 text-white rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 border-2 border-white/30 group z-10">
        <svg class="w-6 h-6 md:w-7 md:h-7 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7" />
        </svg>
    </button>
    
    <button onclick="nextSlide()" 
            class="absolute right-4 md:right-8 top-1/2 -translate-y-1/2 w-12 h-12 md:w-14 md:h-14 bg-white/10 backdrop-blur-md hover:bg-white/20 text-white rounded-full flex items-center justify-center transition-all duration-300 hover:scale-110 border-2 border-white/30 group z-10">
        <svg class="w-6 h-6 md:w-7 md:h-7 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7" />
        </svg>
    </button>

    <!-- Dots Indicator -->
    <div class="absolute bottom-6 left-1/2 -translate-x-1/2 flex gap-3 z-10">
        {% for s in sliders %}
        <button onclick="goToSlide({{ forloop.counter0 }})" 
                class="slider-dot w-3 h-3 rounded-full bg-white/40 hover:bg-white/70 transition-all duration-300 {{ forloop.first|yesno:'active,,' }}"
                data-index="{{ forloop.counter0 }}">
        </button>
        {% endfor %}
    </div>

    <!-- Progress Bar -->
    <div class="absolute bottom-0 left-0 w-full h-1 bg-white/20">
        <div id="progress-bar" class="h-full bg-[#D3B689] transition-all duration-300 ease-linear" style="width: 0%"></div>
    </div>
</div>

<style>
    @keyframes fade-in {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    @keyframes slide-up {
        from { 
            opacity: 0;
            transform: translateY(30px);
        }
        to { 
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .animate-fade-in {
        animation: fade-in 0.8s ease-out;
    }
    
    .animate-slide-up {
        animation: slide-up 0.8s ease-out 0.2s both;
    }
    
    .animate-slide-up-delay {
        animation: slide-up 0.8s ease-out 0.4s both;
    }
    
    .animate-slide-up-delay-2 {
        animation: slide-up 0.8s ease-out 0.6s both;
    }

    .slider-dot.active {
        background-color: white;
        width: 2rem;
        border-radius: 0.5rem;
    }

    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>

<script>
let currentIndex = 0;
const slides = document.querySelectorAll("#slider-container > div");
const dots = document.querySelectorAll(".slider-dot");
let autoPlayInterval;
let progressInterval;

function updateDots() {
    dots.forEach((dot, index) => {
        if (index === currentIndex) {
            dot.classList.add('active');
        } else {
            dot.classList.remove('active');
        }
    });
}

function updateProgress() {
    const progressBar = document.getElementById('progress-bar');
    let width = 0;
    clearInterval(progressInterval);
    
    progressInterval = setInterval(() => {
        if (width >= 100) {
            clearInterval(progressInterval);
        } else {
            width += 0.5;
            progressBar.style.width = width + '%';
        }
    }, 25);
}

function showSlide(index) {
    const container = document.getElementById("slider-container");
    container.style.transform = `translateX(-${index * 100}%)`;
    updateDots();
    updateProgress();
}

function nextSlide() {
    currentIndex = (currentIndex + 1) % slides.length;
    showSlide(currentIndex);
    resetAutoPlay();
}

function prevSlide() {
    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
    showSlide(currentIndex);
    resetAutoPlay();
}

function goToSlide(index) {
    currentIndex = index;
    showSlide(currentIndex);
    resetAutoPlay();
}

function startAutoPlay() {
    autoPlayInterval = setInterval(nextSlide, 5000);
}

function resetAutoPlay() {
    clearInterval(autoPlayInterval);
    startAutoPlay();
}

// Initialize
updateDots();
updateProgress();
startAutoPlay();

// Pause on hover
const sliderContainer = document.getElementById("slider-container");
sliderContainer.addEventListener('mouseenter', () => {
    clearInterval(autoPlayInterval);
    clearInterval(progressInterval);
});
sliderContainer.addEventListener('mouseleave', () => {
    resetAutoPlay();
    updateProgress();
});

// Touch support for mobile
let touchStartX = 0;
let touchEndX = 0;

sliderContainer.addEventListener('touchstart', e => {
    touchStartX = e.changedTouches[0].screenX;
});

sliderContainer.addEventListener('touchend', e => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
});

function handleSwipe() {
    if (touchEndX < touchStartX - 50) nextSlide();
    if (touchEndX > touchStartX + 50) prevSlide();
}

// Keyboard navigation
document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft') prevSlide();
    if (e.key === 'ArrowRight') nextSlide();
});
</script>